# DataAnalytics-Assessment

## Assessment Overview
Queries to get the following:
- High-Value Customers with Multiple Products
- Transaction Frequency Analysis
- Account Inactivity Alert
- Customer Lifetime Value (CLV) Estimation

## Tables
- users_customuser: customer demographic and contact information
- savings_savingsaccount: records of deposit transactions
- plans_plan: records of plans created by customers
- withdrawals_withdrawal:  records of withdrawal transactions

## Queries
### 1. **High-Value Customers with Multiple Products**
Query Description

The query performs the following operations:
Joins three tables:
- users_customuser – contains user details.
- savings_savingsaccount – holds savings transaction records.
- plans_plan – contains investment and savings plan information.

**Filters:**

Only includes users with plans marked as investments (is_a_fund = 1) and regular savings (is_regular_savings = 1).

**Selects:**

- owner_id: Unique identifier of the customer.
- name: Concatenation of first_name and last_name.
- savings_count: Number of unique savings accounts (savings_id) per customer.
- investment_count: Count of unique investment flags (is_a_fund) per customer.
- total_deposits: Total amount deposited by the customer.

Groups the result by owner_id.

Orders the final output by total_deposits in descending order.



### 2. **Transaction Frequency Analysis**

**Query Description**

The query performs the following operations:
Classifies users into:
- High Frequency (more than 9 transactions in a month)
- Medium Frequency (3–9 transactions)
- Low Frequency (fewer than 3 transactions)

Calculates Customers Transaction Volume 

Calculates average monthly transactions for each frequency category and customer using 2 CTE's Frequency and Average

**CTE's**
- Frequency:
    - Groups transactions per customer by month.
    - Counts how many savings transactions (savings_id) occurred.
    - Assigns a frequency category based on the transaction count.
       
- Average
    - Aggregates data to compute the average number of transactions per customer within each frequency category and month.
 
**Final Output**
- Returns the customers frequency classification, transaction volume per customer in a month and the average transaction volume for that frequency group.



### 3. **Account Inactivity Alert**

**Query Description**

The SQL query identifies customer plans (savings or investments) that have been inactive for more than 365 days by analyzing the most recent transaction date per user.

It performs the following operations:
- Classify each plan as either Savings or Investment.
- Fetch the most recent transaction for each user (owner_id).
- Filter for customers with no activity in over a year.

**CTE**
- AccountActivity
   - Joins plans_plan and savings_savingsaccount tables on the customerid (owner_id).

Categorizes each plan into:
    - Savings → if is_regular_savings = 1
    - Investment otherwise
- Uses ROW_NUMBER() to find the most recent transaction per customer.
- Calculates how many days since the last transaction with DATEDIFF.

**Final Output**
- Only includes customer who haven't transacted in over a year.
- Limits results to each customer’s latest transaction only (rn = 1).
  

### 4. **Customer Lifetime Value (CLV) Estimation**

**Query Description**
The query displays the following:
- customer_id:	Unique ID of the customer
- name:	Full name of the customer
- tenure_months: 	Total duration (in months) between maturity start and end date
- total_transactions:	Count of all savings transactions tied to the customer
- estimated_clv:	Estimated annual value generated by the customer based on confirmed savings and a 10% interest projection

**Joins**
Joins two tables:
- users_customuser – contains user details.
- savings_savingsaccount – holds savings transaction records.

**Aggregates:**
- The Frequency of Savings (COUNT(b.Savings_id)) to get transaction volume
- To get Average Transaction volume to calculate Estimated CLV

**Group By:**
- Customers Name (which is concatenated in the select statement)
- Transaction Month

  It's Ordered by the calculated CLV in descending order.










